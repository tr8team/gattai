version: v1
type: CommandLineInterface
params:
  identifier:
    desc: The rds cluster identifier
    requied: true
    type: string
  query:
    desc: The rds cluster query
    requied: true
    type: string
return: {{ stdout }}
spec:
  nix:
    package: aws-cli
    version: v1
  test:
    - cmd:
      - aws
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - rds describe-db-clusters
  cmds:
    - cmd:
      - aws
      {{- with .Args }}
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - rds describe-db-clusters
      {{- when .identifier }}
      - --db-cluster-identifier {{ . }}
      {{- end }}
      {{- when .query }}
      - --query "DBClusters[0].{{ . }}"
      {{- end }}
      {{- end }}
