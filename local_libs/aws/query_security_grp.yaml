version: v1
type: CommandLineInterface
params:
  identifier:
    desc: The security grp identifier
    requied: true
    type: string
  query:
    desc: The security grp query
    requied: true
    type: string
return: "stdout"
spec:
  test:
    - cmd:
      - aws
      {{- with .Args }}
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - ec2 describe-security-groups
      {{- end }}
  cmds:
    - cmd:
      - aws
      {{- with .Args }}
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - ec2 describe-security-groups
      {{- range $key, $val := .filters }}
      - --filter Name={{ $key }},Values={{ $val }}
      {{- end }}
      {{- with .query }}
      - --query "SecurityGroups[0].{{ . }}"
      {{- end }}
      {{- end }}
