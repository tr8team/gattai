version: v1
type: CommandLineInterface
params:
  required:
    region:
      desc: The regiion where the resource is at
      type: string
    identifier:
      desc: The elasticache replica grp identifier
      type: string
    query:
      desc: The elasticache replica grp query
      type: string
spec:
  #nix:
  #  package: aws-cli
  #  version: v1
  test:
    - command: aws
      args:
        {{- with .Vars }}
        {{- with .region }}
        - --region {{ . }}
        {{- end }}
        - elasticache describe-replication-groups
        {{- end }}
  cmds:
    - command: aws
      args:
        {{- with .Vars }}
        {{- with .region }}
        - --region {{ . }}
        {{- end }}
        - elasticache describe-replication-groups
        {{- with .identifier }}
        - --replication-group-id {{ . }}
        {{- end }}
        {{- with .query }}
        - --query "ReplicationGroups[0].{{ . }}"
        {{- end }}
        {{- end }}
