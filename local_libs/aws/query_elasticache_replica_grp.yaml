version: v1
type: CommandLineInterface
params:
  identifier:
    desc: The elasticache replica grp identifier
    requied: true
    type: string
  query:
    desc: The elasticache replica grp query
    requied: true
    type: string
return: "stdout"
nix:
  package: aws-cli
  version: v1
spec:
  test:
    - cmd:
      - aws
      {{- with .Args }}
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - elasticache describe-replication-groups
      {{- end }}
  cmds:
    - cmd:
      - aws
      {{- with .Args }}
      {{- with .region }}
      - --region {{ . }}
      {{- end }}
      - elasticache describe-replication-groups
      {{- with .identifier }}
      - --replication-group-id {{ . }}
      {{- end }}
      {{- with .query }}
      - --query "ReplicationGroups[0].{{ . }}"
      {{- end }}
      {{- end }}
