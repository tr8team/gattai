version: v1
type: CommandLineInterface
spec:
  environment:
    kind: shell
  sub-commands:
    describe-db-instances:v1:
      command: describe-db-instances
      args:
        {{- when .identifier }}
        - --db-instance-identifier {{ . }}
        {{- end }}
        {{- when .query }}
        - --query "DBInstances[0].{{ . }}"
        {{- end }}
  execute:
    v2.7.20: &latest
      command: aws
      args:
        {{- with .Params }}
        {{- with .region }}
        - --region {{ . }}
        {{- end }}
        - command: rds
          args:
            - sub-command: describe-db-instances:v1
              vars:
                identifier: {{ .identifier }}
                query: {{ .query }}
        {{- end }}

    default: *latest
