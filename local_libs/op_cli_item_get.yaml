version: v1
type: CommandLineInterface
params:
  required:
    identifier:
      desc: The one password identifier
      type: string
    label:
      desc: The one password label
      type: string
    vault:
      desc: The one password vault
      type: string
spec:
  runtime-env:
    docker:
      op:
        name: 1password/op
        version: lastest
    nix-shell:
      op:
        name: _1password
        version: https://github.com/NixOS/nixpkgs/archive/6d02a514db95d3179f001a5a204595f17b89cb32.tar.gz
  #test:
  #  - command:
  cmds:
    - command: op
      args:
        {{- with .Vars }}
        {{- with .identifier }}
        - item get "{{ . }}"
        {{- end }}
        {{- with .label }}
        - --fields label={{ . }}
        {{- end }}
        {{- with .vault }}
        - --vault {{ . }}
        {{- end }}
        {{- end }}
